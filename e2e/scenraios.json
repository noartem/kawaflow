{
  "groups": [
    {
      "name": "flow_lifecycle",
      "description": "Basic lifecycle coverage for development runs.",
      "scenarios": [
        {
          "id": "flow_lifecycle_basic",
          "title": "Create -> run -> stop -> delete",
          "summary": "Create a flow, run it, validate container running, stop it, ensure container exited, then delete the flow."
        },
        {
          "id": "flow_lifecycle_rerun",
          "title": "Run twice updates active run",
          "summary": "Run a flow twice and verify the previous run is inactive and the new run is active."
        },
        {
          "id": "flow_lifecycle_restart",
          "title": "Stop then run again",
          "summary": "Stop a running flow and run it again, verify run history and status updates."
        },
        {
          "id": "flow_lifecycle_delete_running",
          "title": "Delete while running",
          "summary": "Delete a running flow and verify the container is removed and flow is cleaned up."
        }
      ]
    },
    {
      "name": "runtime_graph",
      "description": "Runtime actor graph validation and hash checks.",
      "scenarios": [
        {
          "id": "runtime_graph_basic",
          "title": "Graph structure matches code",
          "summary": "Run a flow, fetch runtime graph, validate structure and hash matches code snapshot."
        },
        {
          "id": "runtime_graph_update",
          "title": "Graph hash changes after update",
          "summary": "Update flow code/graph, run again, verify graph hash changes and matches updated code."
        },
        {
          "id": "runtime_graph_labels",
          "title": "Container labels carry graph hash",
          "summary": "Validate container labels include graph hash equal to expected computed hash."
        }
      ]
    },
    {
      "name": "logs_and_events",
      "description": "Flow logs, event delivery, and UI log endpoints.",
      "scenarios": [
        {
          "id": "logs_event_roundtrip",
          "title": "Send message and see log",
          "summary": "Send a message to a running flow and verify the flow logs contain the payload."
        },
        {
          "id": "logs_stop_event",
          "title": "Stop event captured",
          "summary": "Stop a flow and verify logs include stop event or shutdown marker."
        },
        {
          "id": "logs_error_trace",
          "title": "Actor error trace",
          "summary": "Trigger an actor exception and verify UI status is error and logs include traceback."
        },
        {
          "id": "logs_endpoint",
          "title": "Logs endpoint returns entries",
          "summary": "Query flow logs endpoint and verify entries for flow and for run are returned."
        }
      ]
    },
    {
      "name": "auth_and_permissions",
      "description": "Authorization boundaries for flow operations.",
      "scenarios": [
        {
          "id": "auth_no_manage",
          "title": "No manage permissions",
          "summary": "User without manage permissions cannot create/update/delete flows."
        },
        {
          "id": "auth_no_run",
          "title": "No run permissions",
          "summary": "User without run permissions cannot run/stop flows."
        },
        {
          "id": "auth_ownership",
          "title": "Ownership enforced",
          "summary": "User with own permissions cannot access or manage another user's flow."
        },
        {
          "id": "auth_session_expired",
          "title": "Session expires",
          "summary": "Expired session redirects to login for protected routes."
        }
      ]
    },
    {
      "name": "flow_manager_integration",
      "description": "Behavior when flow-manager is restarted or unavailable.",
      "scenarios": [
        {
          "id": "fm_restart",
          "title": "Flow-manager restart",
          "summary": "Restart flow-manager and verify UI recovers flow statuses."
        },
        {
          "id": "fm_unavailable",
          "title": "Flow-manager unavailable",
          "summary": "Attempt run/stop while flow-manager is down and verify UI surfaces error."
        },
        {
          "id": "fm_timeout",
          "title": "Flow-manager timeout",
          "summary": "Simulate response timeout and ensure UI handles failure cleanly."
        }
      ]
    },
    {
      "name": "concurrency_and_isolation",
      "description": "Parallelism and isolation across flows/users.",
      "scenarios": [
        {
          "id": "concurrency_multi_flows",
          "title": "Create N flows in parallel",
          "summary": "Create multiple flows concurrently and verify containers and labels for each."
        },
        {
          "id": "concurrency_parallel_messages",
          "title": "Parallel messages",
          "summary": "Send messages to multiple flows and verify logs are not mixed."
        },
        {
          "id": "concurrency_same_name",
          "title": "Same name across users",
          "summary": "Two users create flows with identical names; verify ownership isolation."
        }
      ]
    },
    {
      "name": "production_deploy",
      "description": "Production deploy/undeploy path and lock handling.",
      "scenarios": [
        {
          "id": "prod_deploy_success",
          "title": "Deploy production",
          "summary": "Deploy production flow, verify lock generation and status transitions to ready."
        },
        {
          "id": "prod_undeploy",
          "title": "Undeploy production",
          "summary": "Undeploy production flow and verify container stopped and status updated."
        },
        {
          "id": "prod_deploy_invalid_lock",
          "title": "Invalid lock or image",
          "summary": "Deploy with invalid lock or missing image and verify error surfaced with no running container."
        }
      ]
    },
    {
      "name": "validation_and_edges",
      "description": "Input validation and edge cases.",
      "scenarios": [
        {
          "id": "validation_invalid_code",
          "title": "Invalid code",
          "summary": "Create a flow with invalid code and verify validation error with no container created."
        },
        {
          "id": "validation_invalid_graph",
          "title": "Invalid graph JSON",
          "summary": "Create/update a flow with invalid graph JSON and verify error returned."
        },
        {
          "id": "validation_empty_code",
          "title": "Empty code",
          "summary": "Update a flow with empty code and verify expected error or saved state."
        }
      ]
    },
    {
      "name": "resilience_and_cleanup",
      "description": "Cleanup behavior on failures and orphans.",
      "scenarios": [
        {
          "id": "cleanup_orphaned_containers",
          "title": "Orphan cleanup",
          "summary": "Ensure containers with test_run_id are cleaned up by tests."
        },
        {
          "id": "cleanup_on_failure",
          "title": "Cleanup after test failure",
          "summary": "If a test fails mid-run, verify flows and containers are cleaned up."
        }
      ]
    }
  ]
}
